(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[705],{3413:function(e,t,s){Promise.resolve().then(s.bind(s,2540))},2540:function(e,t,s){"use strict";s.r(t);var l=s(7437),a=s(2265),o=s(8775),r=s(9695),n=s(7346),i=s(5211),d=s(4858),c=s(6648),x=s(1942);i.kL.register(i.qi,i.u,i.De,d.Z),t.default=()=>{let[e,t]=(0,a.useState)(!1),[s,i]=(0,a.useState)(!1),[d,m]=(0,a.useState)([]),[h,u]=(0,a.useState)([]),[g,b]=(0,a.useState)(!1),[v,f]=(0,a.useState)(!1),[j,p]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!0),y=async()=>{try{w(!0);let e=await fetch("https://blockchainvoting-z1xf.onrender.com/api/admin/voting-status");if(!e.ok)throw Error("Failed to fetch voting status");let s=await e.json();t(s.isVotingActive)}catch(e){console.error("Error fetching voting status:",e)}finally{w(!1)}},C=async()=>{try{p(!0);let e=await fetch("https://blockchainvoting-z1xf.onrender.com/api/admin/voting-status/toggle",{method:"POST"});if(!e.ok)throw Error("Failed to toggle voting status");let s=await e.json();t(s.isVotingActive),s.isVotingActive||i(!0)}catch(e){console.error("Error toggling voting status:",e)}finally{p(!1)}},B=async()=>{try{let e=await (0,r.Z)(),t=await e.getWinners();if(!t||0===t.length){console.warn("No winners found."),m([]);return}let s=t.map(e=>{var t,s;return{id:(null==e?void 0:null===(t=e.id)||void 0===t?void 0:t.toString())||"N/A",firstName:(null==e?void 0:e.firstName)||"Unknown",lastName:(null==e?void 0:e.lastName)||"Unknown",position:(null==e?void 0:e.position)||"Unknown",voteCount:(null==e?void 0:null===(s=e.voteCount)||void 0===s?void 0:s.toString())||"0",profileImageHash:(null==e?void 0:e.profileImageHash)||""}});m(s)}catch(e){console.error("Error fetching winners:",e)}},k=async()=>{try{let e=await (0,r.Z)(),t=await e.getAllCandidates();if(!t||0===t.length){console.warn("No candidates found."),u([]);return}let s=t.map(e=>{var t;return{name:"".concat((null==e?void 0:e.firstName)||"Unknown"," ").concat((null==e?void 0:e.lastName)||"Unknown"),votes:parseInt((null==e?void 0:null===(t=e.voteCount)||void 0===t?void 0:t.toString())||"0")}});u(s)}catch(e){console.error("Error fetching votes data:",e)}};(0,a.useEffect)(()=>{y()},[]);let S=async()=>{await B(),await k()};if(N)return(0,l.jsx)(o.Z,{children:(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center space-y-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 border-4 border-logoBlue border-t-transparent rounded-full animate-spin mx-auto"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Loading voting status..."})]})})});let V=Math.max(...h.map(e=>e.votes),0),E=Math.min(...h.map(e=>e.votes),0),A={labels:h.map(e=>e.name),datasets:[{data:h.map(e=>e.votes),backgroundColor:h.map(e=>e.votes===V&&V>0?"#004b84":e.votes===E?"#207C9F":"#012b64"),borderWidth:0,hoverBorderWidth:3,hoverBorderColor:"#fff"}]};return(0,l.jsx)(o.Z,{children:(0,l.jsxs)("div",{className:"p-6 md:p-8",children:[(0,l.jsxs)("div",{className:"mb-12",children:[(0,l.jsxs)("div",{className:"inline-flex items-center space-x-2 bg-logoBlue/10 rounded-full px-4 py-2 mb-4",children:[(0,l.jsx)(x.SRq,{className:"text-logoBlue"}),(0,l.jsx)("span",{className:"text-logoBlue font-semibold",children:"Election Control"})]}),(0,l.jsx)("h1",{className:"text-4xl font-bold text-logoBlue mb-4",children:"Voting Status Management"}),(0,l.jsx)("p",{className:"text-xl text-gray-600",children:"Control the voting process and monitor election results in real-time"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 overflow-hidden mb-8",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-logoBlue to-bgBlue px-8 py-8 text-white relative",children:[(0,l.jsx)("div",{className:"absolute top-4 left-4 w-8 h-8 border-2 border-white/20 rounded-lg rotate-45"}),(0,l.jsx)("div",{className:"absolute top-4 right-4 w-6 h-6 bg-popBlue/30 rounded-full animate-pulse"}),(0,l.jsxs)("div",{className:"text-center relative",children:[(0,l.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl ".concat(e?"bg-green-500":"bg-gray-500"),children:e?(0,l.jsx)(x.gmG,{className:"text-3xl text-white"}):(0,l.jsx)(x.JuG,{className:"text-3xl text-white"})}),(0,l.jsx)("h2",{className:"text-3xl font-bold mb-3",children:e?"Voting is Active":s?"Voting Ended":"Voting Not Started"}),(0,l.jsx)("p",{className:"text-blue-100 text-lg",children:e?"Voters can currently cast their ballots":s?"View the final election results below":"Ready to start the voting process"})]})]}),(0,l.jsxs)("div",{className:"p-8 text-center",children:[!s&&(0,l.jsx)("button",{onClick:()=>{e?b(!0):f(!0)},disabled:j,className:"px-12 py-4 rounded-2xl font-bold text-lg transition-all duration-300 transform hover:scale-105 ".concat(j?"bg-gray-400 text-white cursor-not-allowed":e?"bg-red-500 hover:bg-red-600 text-white hover:shadow-xl":"bg-gradient-to-r from-logoBlue to-bgBlue text-white hover:shadow-xl"),children:j?(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(x.fCD,{className:"animate-spin"}),(0,l.jsx)("span",{children:"Processing..."})]}):(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[e?(0,l.jsx)(x.JuG,{}):(0,l.jsx)(x.gmG,{}),(0,l.jsx)("span",{children:e?"Stop Voting":"Start Voting"})]})}),!e&&s&&(0,l.jsx)("button",{onClick:S,className:"px-12 py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-2xl font-bold text-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(x.yQE,{}),(0,l.jsx)("span",{children:"View Results"})]})})]})]}),!e&&s&&d.length>0&&h.length>0&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 px-8 py-8 text-center relative overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full"}),(0,l.jsx)("div",{className:"absolute -bottom-4 -left-4 w-32 h-32 bg-white/10 rounded-full"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl",children:(0,l.jsx)(x.CvY,{className:"text-4xl text-yellow-500"})}),(0,l.jsx)("h2",{className:"text-3xl font-bold text-white mb-3",children:"\uD83C\uDF89 Election Winner! \uD83C\uDF89"}),(0,l.jsx)("p",{className:"text-yellow-100 text-lg",children:"Congratulations to our newly elected representative"})]})]}),(0,l.jsx)("div",{className:"p-8",children:d.map((e,t)=>(0,l.jsx)("div",{className:"text-center",children:(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"relative inline-block mb-6",children:[(0,l.jsx)("div",{className:"w-32 h-32 rounded-full border-4 border-yellow-400 overflow-hidden bg-gray-100 shadow-xl",children:(0,l.jsx)(c.default,{src:e.profileImageHash?"https://ipfs.io/ipfs/".concat(e.profileImageHash):"/default-avatar.png",alt:"Winner Avatar",width:128,height:128,className:"w-full h-full object-cover"})}),(0,l.jsx)("div",{className:"absolute -top-2 -right-2 w-12 h-12 bg-yellow-500 rounded-full flex items-center justify-center border-4 border-white shadow-lg",children:(0,l.jsx)(x.CvY,{className:"text-yellow-900 text-lg"})})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("h3",{className:"text-3xl font-bold text-logoBlue",children:[e.firstName," ",e.lastName]}),(0,l.jsxs)("div",{className:"inline-flex items-center space-x-2 bg-logoBlue/10 text-logoBlue px-6 py-3 rounded-full font-semibold text-lg",children:[(0,l.jsx)(x.I$,{}),(0,l.jsx)("span",{children:e.position})]}),(0,l.jsxs)("div",{className:"inline-flex items-center space-x-2 bg-green-100 text-green-800 px-6 py-3 rounded-full font-bold text-xl",children:[(0,l.jsx)(x.SRq,{}),(0,l.jsxs)("span",{children:[e.voteCount," Votes"]})]})]})]})},t))})]}),(0,l.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsxs)("div",{className:"inline-flex items-center space-x-2 bg-logoBlue/10 rounded-full px-4 py-2 mb-4",children:[(0,l.jsx)(x.yQE,{className:"text-logoBlue"}),(0,l.jsx)("span",{className:"text-logoBlue font-semibold",children:"Vote Distribution"})]}),(0,l.jsx)("h3",{className:"text-2xl font-bold text-logoBlue mb-4",children:"Election Results"}),(0,l.jsxs)("p",{className:"text-gray-600",children:["Total votes: ",(0,l.jsx)("span",{className:"font-bold text-logoBlue",children:h.reduce((e,t)=>e+t.votes,0)})]})]}),(0,l.jsx)("div",{className:"relative h-80",children:(0,l.jsx)(n.by,{data:A,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:15,padding:15,font:{size:12},usePointStyle:!0}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",bodyColor:"#fff",borderColor:"#004b84",borderWidth:1,callbacks:{label:function(e){let t=e.label||"",s=e.raw||0,l=e.dataset.data.reduce((e,t)=>e+t,0),a=l>0?(s/l*100).toFixed(2):"0";return"".concat(t,": ").concat(s," votes (").concat(a,"%)")}}},datalabels:{color:"white",font:{weight:"bold",size:14},formatter:(e,t)=>{let s=t.dataset.data.reduce((e,t)=>e+t,0),l=s>0?(e/s*100).toFixed(1):"0";return"".concat(l,"%")}}}}})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsxs)("div",{className:"inline-flex items-center space-x-2 bg-logoBlue/10 rounded-full px-4 py-2 mb-4",children:[(0,l.jsx)(x.I$,{className:"text-logoBlue"}),(0,l.jsx)("span",{className:"text-logoBlue font-semibold",children:"Detailed Results"})]}),(0,l.jsx)("h3",{className:"text-2xl font-bold text-logoBlue",children:"Candidate Rankings"})]}),(0,l.jsx)("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:h.sort((e,t)=>t.votes-e.votes).map((e,t)=>{let s=h.reduce((e,t)=>e+t.votes,0),a=s>0?(e.votes/s*100).toFixed(1):"0",o=e.votes===V&&V>0;return(0,l.jsxs)("div",{className:"p-4 rounded-2xl border-2 transition-all duration-300 ".concat(o?"border-yellow-400 bg-yellow-50":"border-gray-200 bg-gray-50 hover:bg-white"),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[o&&(0,l.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,l.jsx)(x.CvY,{className:"text-yellow-900 text-sm"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-semibold ".concat(o?"text-yellow-800":"text-gray-900"),children:e.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["#",t+1," • ",a,"% of votes"]})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-xl font-bold ".concat(o?"text-yellow-800":"text-logoBlue"),children:e.votes}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"votes"})]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"h-2 rounded-full transition-all duration-1000 ".concat(o?"bg-yellow-500":"bg-logoBlue"),style:{width:"".concat(a,"%")}})})]},t)})})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-logoBlue mb-4",children:"Election Statistics"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Complete overview of the election results and participation metrics"})]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,l.jsxs)("div",{className:"text-center p-6 bg-logoBlue/5 rounded-2xl border border-logoBlue/10",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-logoBlue rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)(x.I$,{className:"text-white"})}),(0,l.jsx)("div",{className:"text-2xl font-bold text-logoBlue mb-1",children:h.length}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Total Candidates"})]}),(0,l.jsxs)("div",{className:"text-center p-6 bg-green-50 rounded-2xl border border-green-200",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)(x.SRq,{className:"text-white"})}),(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600 mb-1",children:h.reduce((e,t)=>e+t.votes,0)}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Total Votes Cast"})]}),(0,l.jsxs)("div",{className:"text-center p-6 bg-yellow-50 rounded-2xl border border-yellow-200",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-yellow-500 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)(x.CvY,{className:"text-yellow-900"})}),(0,l.jsx)("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:V}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Winning Vote Count"})]}),(0,l.jsxs)("div",{className:"text-center p-6 bg-purple-50 rounded-2xl border border-purple-200",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)(x.yQE,{className:"text-white"})}),(0,l.jsxs)("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:[h.length>0&&h.reduce((e,t)=>e+t.votes,0)>0?(V/h.reduce((e,t)=>e+t.votes,0)*100).toFixed(1):"0","%"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Winner's Share"})]})]})]})]}),g&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl max-w-md w-full overflow-hidden shadow-2xl",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-red-500 to-red-600 px-8 py-6 text-white text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,l.jsx)(x.gJy,{className:"text-3xl"})}),(0,l.jsx)("h3",{className:"text-2xl font-bold",children:"Stop Voting?"})]}),(0,l.jsxs)("div",{className:"p-8 text-center",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"Stopping the voting process will finalize the election and you won't be able to restart it. Are you sure you want to proceed?"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-semibold",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{b(!1),C()},className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:shadow-lg transition-all duration-200 font-semibold",children:"Yes, Stop Voting"})]})]})]})}),v&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl max-w-md w-full overflow-hidden shadow-2xl",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-logoBlue to-bgBlue px-8 py-6 text-white text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,l.jsx)(x.FJM,{className:"text-3xl"})}),(0,l.jsx)("h3",{className:"text-2xl font-bold",children:"Start Voting?"})]}),(0,l.jsxs)("div",{className:"p-8 text-center",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"Starting the voting process will allow voters to cast their votes. Are you ready to begin the election?"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)("button",{onClick:()=>f(!1),className:"flex-1 px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-semibold",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{f(!1),C()},className:"flex-1 px-6 py-3 bg-gradient-to-r from-logoBlue to-bgBlue text-white rounded-xl hover:shadow-lg transition-all duration-200 font-semibold",children:"Yes, Start Voting"})]})]})]})})]})})}}},function(e){e.O(0,[699,674,853,648,634,640,171,971,23,744],function(){return e(e.s=3413)}),_N_E=e.O()}]);